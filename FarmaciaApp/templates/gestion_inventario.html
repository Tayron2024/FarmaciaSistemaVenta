<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Inventario - Farmacia SanaSana</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: url("https://previews.123rf.com/images/wararat2599/wararat25992311/wararat2599231103693/218781620-un-concepto-de-farmac%C3%A9utico-y-medicina-de-farmacia-fondo-borroso.jpg") no-repeat center center fixed;
            background-size: cover;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
        }

        header {
            width: 100%;
            background: rgba(0, 123, 255, 0.9);
            color: white;
            padding: 15px;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
        }

        nav {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: bold;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            max-width: 1000px;
            width: 90%;
            margin-top: 80px; /* Margen superior para evitar solapamiento con el header */
            margin-bottom: 100px; /* Margen inferior para evitar solapamiento con el footer */
            overflow-y: auto; /* Hacer el contenedor desplazable verticalmente */
            max-height: 70vh; /* Limitar la altura del contenedor */
        }

        h2 {
            color: #007BFF;
            margin-bottom: 20px;
            font-size: 22px;
        }

        .table-container {
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }

        th {
            background: #007BFF;
            color: white;
            font-weight: bold;
        }

        td input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }

        button {
            background: #28a745;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: 0.3s;
        }

        button:hover {
            background: #218838;
        }

        .action-btn {
            background: #dc3545;
            margin-left: 5px;
        }

        .action-btn:hover {
            background: #c82333;
        }

        footer {
            width: 100%;
            background: rgba(0, 123, 255, 0.9);
            color: white;
            padding: 10px;
            text-align: center;
            position: fixed;
            bottom: 0;
            left: 0;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <header>
        Gestión de Inventario - Farmacia SanaSana
        <nav>
            <a href="#" onclick="resetInventario()">Reiniciar Inventario</a>
        </nav>
    </header>

    <main class="container">
        <!-- Tabla de inventario general -->
        <div class="table-container">
            <h2>Inventario General</h2>
            <button class="btn" onclick="agregarProducto()">Añadir nuevo ítem</button>
            <table id="tabla-inventario">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Cantidad</th>
                        <th>Precio</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Los datos se cargarán dinámicamente desde localStorage -->
                </tbody>
            </table>
        </div>

        <!-- Tabla de inventario por sucursal -->
        <div class="table-container">
            <h2>Inventario por Sucursal</h2>
            <table id="tabla-sucursales">
                <thead>
                    <tr>
                        <th>Sucursal</th>
                        <th>Producto</th>
                        <th>Cantidad</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Los datos se cargarán dinámicamente desde localStorage -->
                </tbody>
            </table>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Farmacia SanaSana. Todos los derechos reservados.</p>
    </footer>

    <script>
        // Inicializar datos en localStorage si no existen
        const datosFarmacia = JSON.parse(localStorage.getItem("datosFarmacia")) || {
            productos: [
                { nombre: "Ibuprofeno", cantidad: 150, precio: 2.50 },
                { nombre: "Paracetamol", cantidad: 200, precio: 2.50 },
                { nombre: "Amoxicilina", cantidad: 100, precio: 5.00 },
                { nombre: "Naproxeno", cantidad: 180, precio: 4.00 },
                { nombre: "Loratadina", cantidad: 250, precio: 3.00 },
                { nombre: "Omeprazol", cantidad: 120, precio: 6.00 },
            ],
            sucursales: [
                {
                    nombre: "Sucursal Norte",
                    productos: [
                        { nombre: "Ibuprofeno", cantidad: 50 },
                        { nombre: "Paracetamol", cantidad: 70 },
                        { nombre: "Amoxicilina", cantidad: 30 },
                    ],
                },
                {
                    nombre: "Sucursal Sur",
                    productos: [
                        { nombre: "Ibuprofeno", cantidad: 40 },
                        { nombre: "Paracetamol", cantidad: 60 },
                        { nombre: "Amoxicilina", cantidad: 20 },
                    ],
                },
                {
                    nombre: "Sucursal Este",
                    productos: [
                        { nombre: "Ibuprofeno", cantidad: 60 },
                        { nombre: "Paracetamol", cantidad: 80 },
                        { nombre: "Amoxicilina", cantidad: 40 },
                    ],
                },
            ],
        };

        if (!localStorage.getItem("datosFarmacia")) {
            localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
        }

        // Llenar la tabla de inventario de productos
        const tablaInventario = document.getElementById("tabla-inventario").getElementsByTagName("tbody")[0];

        function actualizarTablaInventario() {
            tablaInventario.innerHTML = ""; // Limpiar la tabla
            datosFarmacia.productos.forEach((producto, index) => {
                const row = tablaInventario.insertRow();
                row.innerHTML = `
                    <td><input type="text" value="${producto.nombre}" onchange="actualizarNombre(${index}, this.value)"></td>
                    <td><input type="number" value="${producto.cantidad}" onchange="actualizarCantidad(${index}, this.value)"></td>
                    <td><input type="number" value="${producto.precio}" onchange="actualizarPrecio(${index}, this.value)"></td>
                    <td>
                        <button class="action-btn" onclick="eliminarProducto(${index})">Eliminar</button>
                    </td>
                `;
            });
        }

        // Función para actualizar el nombre de un producto
        function actualizarNombre(index, nombre) {
            datosFarmacia.productos[index].nombre = nombre;
            localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
        }

        // Función para actualizar la cantidad de un producto
        function actualizarCantidad(index, cantidad) {
            datosFarmacia.productos[index].cantidad = parseInt(cantidad);
            localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
        }

        // Función para actualizar el precio de un producto
        function actualizarPrecio(index, precio) {
            datosFarmacia.productos[index].precio = parseFloat(precio);
            localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
        }

        // Función para eliminar un producto
        function eliminarProducto(index) {
            if (confirm("¿Estás seguro de eliminar este producto?")) {
                datosFarmacia.productos.splice(index, 1);
                localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
                actualizarTablaInventario();
            }
        }

        // Función para agregar un nuevo producto
        function agregarProducto() {
            const nombre = prompt("Nombre del producto:");
            const cantidad = parseInt(prompt("Cantidad:"));
            const precio = parseFloat(prompt("Precio:"));

            if (nombre && !isNaN(cantidad) && !isNaN(precio)) {
                datosFarmacia.productos.push({ nombre, cantidad, precio });
                localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
                actualizarTablaInventario();
            } else {
                alert("Datos inválidos. Inténtalo de nuevo.");
            }
        }

        // Llenar la tabla de inventario de sucursales
        const tablaSucursales = document.getElementById("tabla-sucursales").getElementsByTagName("tbody")[0];

        function actualizarTablaSucursales() {
            tablaSucursales.innerHTML = ""; // Limpiar la tabla
            datosFarmacia.sucursales.forEach((sucursal, sucursalIndex) => {
                sucursal.productos.forEach((producto, productoIndex) => {
                    const row = tablaSucursales.insertRow();
                    row.innerHTML = `
                        <td><input type="text" value="${sucursal.nombre}" onchange="actualizarNombreSucursal(${sucursalIndex}, this.value)"></td>
                        <td><input type="text" value="${producto.nombre}" onchange="actualizarNombreProductoSucursal(${sucursalIndex}, ${productoIndex}, this.value)"></td>
                        <td><input type="number" value="${producto.cantidad}" onchange="actualizarCantidadProductoSucursal(${sucursalIndex}, ${productoIndex}, this.value)"></td>
                        <td>
                            <button class="action-btn" onclick="eliminarProductoSucursal(${sucursalIndex}, ${productoIndex})">Eliminar</button>
                        </td>
                    `;
                });
            });
        }

        // Función para actualizar el nombre de una sucursal
        function actualizarNombreSucursal(index, nombre) {
            datosFarmacia.sucursales[index].nombre = nombre;
            localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
        }

        // Función para actualizar el nombre de un producto en una sucursal
        function actualizarNombreProductoSucursal(sucursalIndex, productoIndex, nombre) {
            datosFarmacia.sucursales[sucursalIndex].productos[productoIndex].nombre = nombre;
            localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
        }

        // Función para actualizar la cantidad de un producto en una sucursal
        function actualizarCantidadProductoSucursal(sucursalIndex, productoIndex, cantidad) {
            datosFarmacia.sucursales[sucursalIndex].productos[productoIndex].cantidad = parseInt(cantidad);
            localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
        }

        // Función para eliminar un producto de una sucursal
        function eliminarProductoSucursal(sucursalIndex, productoIndex) {
            if (confirm("¿Estás seguro de eliminar este producto de la sucursal?")) {
                datosFarmacia.sucursales[sucursalIndex].productos.splice(productoIndex, 1);
                localStorage.setItem("datosFarmacia", JSON.stringify(datosFarmacia));
                actualizarTablaSucursales();
            }
        }

        // Función para reiniciar el inventario
        function resetInventario() {
            if (confirm("¿Estás seguro de reiniciar el inventario? Se perderán todos los datos.")) {
                localStorage.removeItem("datosFarmacia");
                location.reload(); // Recargar la página para cargar los datos iniciales
            }
        }

        // Cargar las tablas al iniciar la página
        actualizarTablaInventario();
        actualizarTablaSucursales();
    </script>
</body>
</html>